- https://github.com/lief-project/LIEF/issues/764
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-38307


This bug is triggered when a user-controlled map with a nullptr member is passed in without proper checking. But beyond that, I discovered an interesting attack surface related to end_iterators. Applying `std::begin()` to an empty container can result in an end_iterator being returned and subsequently used.

To exploit this bug, you need to layout a heap fengshui to hijack `it->second` ptr and forge a fake SegmentCommand class for subsequent `file_offset()` member function call which can take over the control flow.